# Long Function

No one wants to see 300 lines of code in a function. The main technique to solve this problem will be *Extract Function*

**Marked**

- If you feel like to leave a comment describing what it does, it could mean that the code block and what it does have pretty far semantic distance.


### 1. Replace Temp with Query (178p) ###

The most advantage of using this technique is decoupling code block dependencies that have been generated by mutating variables.

Extracting and reforming temporal variables into pure functions will make it easier to reduce side effect and hidden bugs sleeping under.

##### Examples

```ts
class Order {
    constructor(private readonly quantity: number, 
                private readonly item: Item) {
    }

    get price() {
        let basePrice = this.quantity * this.item.price;
        let discountFactor = 0.98;
        if (basePrice > 1000) discountFactor -= 0.03;
        return basePrice * discountFactor;
    }
}
```

can evolve as 

```ts
class Order {
    constructor(private readonly quantity: number,
                private readonly item: Item) {
    }

    get basePrice() {
        return this.quantity * this.item.price;
    }

    get discountFactor() {
        let discountFactor = 0.98;
        if (this.basePrice > 1000) discountFactor -= 0.03;
        return discountFactor;
    }
    get price() {
        return this.basePrice * this.discountFactor;
    }
}
```

### 2. Introduce Parameter Object (140p) ###

Parameter *group* that sails together all the time. Redefine them as a constructor so that they can be a group and the parameters build a relationship in contextual meaning.

### 4. Replace Function with Command (337p) ###

Use *Command Pattern*'s Command object to encapsulate the function and required parameters so that they remain independent. And for sure, Command Pattern is a pattern for inversed operations as well.

### 5. Decompose Conditional (260p) ###

It's often better extract the complicated conditional into a function which will describe so much better in the context.

##### Examples

```c++
std::list<Entity*> entities = EntityManager::I().GetEntities();
if (!entities.empty())
{
    resetFocusToEntities();
}

// can self-describe a lot better with
bool requireFocus() 
{
    return EntityManager::I().GetEntities().empty() == false;
}

if (requireFocus())
{
    resetFocusToEntities();
}
```

```ts
if (!aDate.isBefore(plan.winterStart) && !aDate.isAfter(plan.winterEnd))
  charge = quantity * plan.winterRate;
else
  charge = quantity * plan.regularRate + plan.regularServiceCharge;

// could do better like

function winterSeason(): bool {
    return !aDate.isBefore(plan.winterStart) && !aDate.isAfter(plan.winterEnd);
}
function winterCharge(): number {
    return quantity * plan.winterRate;
}
function regularCharge(): number {
    return quantity * plan.regularRate + plan.regularServiceCharge;
}

if (winterSeason())
  charge = winterCharge();
else
  charge = regularCharge();
```